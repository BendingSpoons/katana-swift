<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Katana  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="Katana  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Katana Docs</a> (100% documented)</p>
        <p class="header-right"><a href="https://github.com/BendingSpoons/katana-swift"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Katana Reference</a>
        <img id="carat" src="img/carat.png" />
        Katana  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/EmptySideEffectDependencyContainer.html">EmptySideEffectDependencyContainer</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Store.html">Store</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/AsyncActionState.html">AsyncActionState</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Action.html">Action</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ActionWithSideEffect.html">ActionWithSideEffect</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/AnyAsyncAction.html">AnyAsyncAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/AnyStore.html">AnyStore</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/AsyncAction.html">AsyncAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/LinkeableAction.html">LinkeableAction</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SideEffectDependencyContainer.html">SideEffectDependencyContainer</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/State.html">State</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/ActionLinker.html">ActionLinker</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ActionLinks.html">ActionLinks</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:6Katana13StoreDispatcha">StoreDispatch</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:6Katana13StoreListenera">StoreListener</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:6Katana15StoreMiddlewarea">StoreMiddleware</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:6Katana16StoreUnsubscribea">StoreUnsubscribe</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <p><img src="https://raw.githubusercontent.com/BendingSpoons/katana-swift/master/Assets/katana_header.png" alt="Katana"></p>

<p><a href="https://twitter.com/katana_swift"><img src="https://img.shields.io/twitter/url/https/twitter.com/fold_left.svg?style=social&label=Follow%20katana_swift" alt="Twitter URL"></a>
<a href="https://travis-ci.org/BendingSpoons/katana-swift"><img src="https://travis-ci.org/BendingSpoons/katana-swift.svg?branch=master" alt="Build Status"></a>
<a href=""><img src="https://img.shields.io/cocoapods/metrics/doc-percent/Katana.svg" alt="Docs"></a>
<a href="https://github.com/Carthage/Carthage"><img src="https://img.shields.io/badge/Carthage-compatible-4BC51D.svg?style=flat" alt="Carthage compatible"></a>
<a href=""><img src="https://img.shields.io/cocoapods/v/Katana.svg" alt="CocoaPods"></a>
<a href="https://github.com/BendingSpoons/katana-swift/blob/master/LICENSE"><img src="https://img.shields.io/badge/Licence-MIT-lightgrey.svg" alt="Licence"></a></p>

<p>Katana is a modern Swift framework for writing iOS applications business logic that are testable and easy to reason about. Katana is strongly inspired by <a href="http://redux.js.org/">Redux</a>.</p>

<p>In few words, the app state is entirely described by a single serializable data structure, and the only way to change the state is to dispatch an action. An action is an intent to transform the state, and contains all the information to do so. Because all the changes are centralized and are happening in a strict order, there are no subtle race conditions to watch out for.</p>

<p>We feel that Katana helped us a lot since we started using it in production. Our applications have been downloaded several milions of times and Katana really helped us scaling them quickly and efficiently. <a href="http://www.bendingspoons.com">Bending Spoons</a>&lsquo;s engineers leverage Katana capabilities to design, implement and test complex applications very quickly without any compromise to the final result. </p>

<p>We use a lot of open source projects ourselves and we wanted to give something back to the community, hoping you will find this useful and possibly contribute. ❤️ </p>
<h2 id='where-is-the-ui' class='heading'>Where is the UI?</h2>

<p>The previous version of this library was a mix of UI and logic. Our idea was to create a framework to structure the application as a whole. By using Katana in more and more apps, we felt it was better to split the library in two pieces: logic, which you can find in this repository, and UI, that has been moved into a <a href="https://github.com/BendingSpoons/katana-ui-swift">separated repository</a>. You can also find the previous readme and source code <a href="https://github.com/BendingSpoons/katana-swift/tree/a87dbe114458a46032d94e577b2fc5896a9a870f">here</a>.</p>

<p>We wrote several successful applications using the declarative UI layer that Katana provides. We 
still think that the declarative approach is really a good one when it comes to complex UIs that have to manage several states and transitions. At the same time, we also spent a considerable amunt of time bridging UIKit&rsquo;s features into Katana UI layer. While in some cases the bridge was easy to implement, in other cases we had to create non trivial code to manage the gap between UIKit and Katana. We felt that being continously in contrast with UIKit really wasn&rsquo;t the way to go and so we decided to put some effort to fix this problem. The result is <a href="https://github.com/BendingSpoons/tempura-lib-swift">Tempura</a>. Tempura is a lightweight, UIKit friendly, UI layer that aims to provide a declarative-like approach to UI without being in contrast with UIKit. We love it, and we really encourage you to <a href="https://github.com/BendingSpoons/tempura-lib-swift">check it out</a>! </p>
<h2 id='overview' class='heading'>Overview</h2>

<p>Your entire app <code><a href="Protocols/State.html">State</a></code> is defined in a single struct, all the relevant application information should be placed here.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">CounterState</span><span class="p">:</span> <span class="kt">State</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">counter</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">}</span>
</code></pre>

<p>The app <code><a href="Protocols/State.html">State</a></code> can only be modified by an <code><a href="Protocols/Action.html">Action</a></code>. An <code><a href="Protocols/Action.html">Action</a></code> represents an event that leads to a change in the <code><a href="Protocols/State.html">State</a></code> of the app. You define the behaviour of the action implementing the <code>updatedState()</code> method that will return the new app <code><a href="Protocols/State.html">State</a></code> based on the current app <code><a href="Protocols/State.html">State</a></code> and the <code><a href="Protocols/Action.html">Action</a></code> itself.</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">IncrementCounter</span><span class="p">:</span> <span class="kt">Action</span> <span class="p">{</span>
  <span class="kd">func</span> <span class="nf">updatedState</span><span class="p">(</span><span class="nv">currentState</span><span class="p">:</span> <span class="kt">State</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">State</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">var</span> <span class="nv">state</span> <span class="o">=</span> <span class="n">currentState</span> <span class="k">as?</span> <span class="kt">CounterState</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="n">currentState</span> <span class="p">}</span>
    <span class="n">state</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">state</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>The <code><a href="Classes/Store.html">Store</a></code> contains and manages your entire app <code><a href="Protocols/State.html">State</a></code> and it is responsible for dispatching <code>Actions</code> and updating the <code><a href="Protocols/State.html">State</a></code>.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">store</span> <span class="o">=</span> <span class="kt">Store</span><span class="o">&lt;</span><span class="kt">CounterState</span><span class="o">&gt;</span><span class="p">()</span>
<span class="n">store</span><span class="o">.</span><span class="nf">dispatch</span><span class="p">(</span><span class="kt">IncrementCounter</span><span class="p">())</span>
</code></pre>

<p>You can ask the <code><a href="Classes/Store.html">Store</a></code> to be notified about every change in the app <code><a href="Protocols/State.html">State</a></code>.</p>
<pre class="highlight swift"><code><span class="n">store</span><span class="o">.</span><span class="nf">addListener</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// the app state has changed</span>
<span class="p">}</span>
</code></pre>
<h2 id='side-effects' class='heading'>Side Effects</h2>

<p>Updating the application&rsquo;s state using pure functions is nice and it has a lot of benefits. Applications have to deal with the external world though (e.g., API call, disk files management, …). For all this kind of operations, Katana provides the concept of  <code>side effects</code>. Side effects can be used to interact with other part of your applications and then dispatch new actions to update your state.</p>

<p>In order to leverage this functionality you have to adopt the <code><a href="Protocols/ActionWithSideEffect.html">ActionWithSideEffect</a></code> protocol</p>
<pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">IncrementCounter</span><span class="p">:</span> <span class="kt">ActionWithSideEffect</span> <span class="p">{</span>
  <span class="kd">func</span> <span class="nf">updatedState</span><span class="p">(</span><span class="nv">currentState</span><span class="p">:</span> <span class="kt">State</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">State</span> <span class="p">{</span>
    <span class="c1">// some update state code here if needed</span>
  <span class="p">}</span>

  <span class="kd">func</span> <span class="nf">sideEffect</span><span class="p">(</span>
    <span class="nv">currentState</span><span class="p">:</span> <span class="kt">State</span><span class="p">,</span>
    <span class="nv">previousState</span><span class="p">:</span> <span class="kt">State</span><span class="p">,</span>
    <span class="nv">dispatch</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt">StoreDispatch</span><span class="p">,</span>
    <span class="nv">dependencies</span><span class="p">:</span> <span class="kt">SideEffectDependencyContainer</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// your logic here (e.g., network call)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h4 id='dependencies' class='heading'>Dependencies</h4>

<p>The last parameter of the side effect method signature is <code>dependencies</code>. This is the Katana way of doing dependency injection. We test our side effects, and because of this we need to get rid of singletons or other bad pratices that prevent us from writing tests. Create a dependency container is very easy: just create a class that implements the <code><a href="Protocols/SideEffectDependencyContainer.html">SideEffectDependencyContainer</a></code> protocol and use it in the side effect</p>
<pre class="highlight swift"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">AppDependencies</span><span class="p">:</span> <span class="kt">SideEffectDependencyContainer</span> <span class="p">{</span>
    <span class="kd">required</span> <span class="nf">init</span><span class="p">(</span><span class="nv">dispatch</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt">StoreDispatch</span><span class="p">,</span> <span class="nv">getState</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">State</span><span class="p">)</span> <span class="p">{</span>
       <span class="c1">// initialize your dependencies here</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='where-to-go-from-here' class='heading'>Where to go from here</h2>
<h3 id='give-it-a-shot' class='heading'>Give it a shot</h3>
<pre class="highlight plaintext"><code>pod try Katana
</code></pre>
<h3 id='tempura' class='heading'>Tempura</h3>

<p>Make awesome applications using Katana together with <a href="https://github.com/BendingSpoons/tempura-lib-swift">Tempura</a></p>
<h3 id='check-out-the-documentation' class='heading'>Check out the documentation</h3>

<p><a href="http://katana.bendingspoons.com">Documentation</a></p>
<h2 id='installation' class='heading'>Installation</h2>

<p>Katana is available through <a href="https://cocoapods.org/">CocoaPods</a> and <a href="https://github.com/Carthage/Carthage">Carthage</a>, you can also drop <code>Katana.project</code> into your Xcode project.</p>
<h3 id='requirements' class='heading'>Requirements</h3>

<ul>
<li><p>iOS 8.4+ / macOS 10.10+</p></li>
<li><p>Xcode 8.0+</p></li>
<li><p>Swift 4.0+</p></li>
</ul>
<h3 id='cocoapods' class='heading'>CocoaPods</h3>

<p><a href="https://cocoapods.org/">CocoaPods</a> is a dependency manager for Cocoa projects. You can install it with the following command:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>sudo gem install cocoapods
</code></pre>

<p>To integrate Katana into your Xcode project using CocoaPods you need to create a <code>Podfile</code>.</p>

<p>For iOS platforms, this is the content</p>
<pre class="highlight ruby"><code><span class="n">use_frameworks!</span>
<span class="n">source</span> <span class="s1">'https://github.com/CocoaPods/Specs.git'</span>
<span class="n">platform</span> <span class="ss">:ios</span><span class="p">,</span> <span class="s1">'8.4'</span>

<span class="n">target</span> <span class="s1">'MyApp'</span> <span class="k">do</span>
  <span class="n">pod</span> <span class="s1">'Katana'</span>
<span class="k">end</span>
</code></pre>

<p>Now, you just need to run:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>pod install
</code></pre>
<h3 id='carthage' class='heading'>Carthage</h3>

<p><a href="https://github.com/Carthage/Carthage">Carthage</a> is a decentralized dependency manager for Cocoa projects. 
You can install Carthage downloading and running the <code>Carthage.pkg</code> file you can download from <a href="https://github.com/Carthage/Carthage/releases">here</a> or you can install it using <a href="http://brew.sh/">Homebrew</a> simply by running:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>brew update
<span class="gp">$ </span>brew install carthage
</code></pre>

<p>To integrate Katana into your Xcode project using Carthage, add it to your <code>Cartfile</code>:</p>
<pre class="highlight plaintext"><code>github "Bendingspoons/katana-swift"
</code></pre>

<p>And Run:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>carthage update
</code></pre>

<p>Then drag the built <code>Katana.framework</code> into your Xcode project.</p>
<h2 id='get-in-touch' class='heading'>Get in touch</h2>

<ul>
<li>if you have <strong>any questions</strong> you can find us on twitter: <a href="https://twitter.com/maurobolis">@maurobolis</a>, <a href="https://twitter.com/luca_1987">@luca_1987</a>, <a href="https://twitter.com/smaramba">@smaramba</a></li>
</ul>
<h2 id='special-thanks' class='heading'>Special thanks</h2>

<ul>
<li><a href="http://bendingspoons.com/team.html">Everyone at Bending Spoons</a> for providing their priceless input;</li>
<li><a href="https://twitter.com/orta">@orta</a> for providing input on how to opensource the project.</li>
</ul>
<h2 id='contribute' class='heading'>Contribute</h2>

<ul>
<li>If you&rsquo;ve <strong>found a bug</strong>, open an issue;</li>
<li>If you have a <strong>feature request</strong>, open an issue;</li>
<li>If you <strong>want to contribute</strong>, submit a pull request;</li>
<li>If you <strong>have an idea</strong> on how to improve the framework or how to spread the word, please <a href="#get-in-touch">get in touch</a>;</li>
<li>If you want to <strong>try the framework</strong> for your project or to write a demo, please send us the link of the repo.</li>
</ul>
<h2 id='license' class='heading'>License</h2>

<p>Katana is available under the <a href="https://github.com/BendingSpoons/katana-swift/blob/master/LICENSE">MIT license</a>.</p>
<h2 id='about' class='heading'>About</h2>

<p>Katana is maintained by Bending Spoons.
We create our own tech products, used and loved by millions all around the world.
Interested? <a href="http://bndspn.com/2fKggTa">Check us out</a>!</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2018 <a class="link" href="http://bendingspoons.com" target="_blank" rel="external">Bending Spoons Team</a>. All rights reserved. (Last updated: 2018-02-21)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.1</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
